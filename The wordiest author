The provided code segment initiates the creation of a database table called "books" with columns for book identification, author name, 
title, and the word count of each book. It then proceeds to insert data into the table, including books by J.K. Rowling, Stephenie Meyer, 
and J.R.R. Tolkien, along with their respective titles and word counts.

Following the data insertion, two queries are executed on the "books" table. The first query retrieves the authors and their total word 
count, aggregated by author, for books that have a cumulative word count equal to or exceeding one million words. This facilitates 
identifying authors who have written a substantial volume of text.

The second query calculates the average word count per book for each author, again grouped by author. The results are filtered to 
display only those authors whose average word count exceeds 150,000 words. This query provides insights into authors who tend to write 
longer books on average.


CREATE TABLE books (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    author TEXT,
    title TEXT,
    words INTEGER);
    
INSERT INTO books (author, title, words)
    VALUES ("J.K. Rowling", "Harry Potter and the Philosopher's Stone", 79944);
INSERT INTO books (author, title, words)
    VALUES ("J.K. Rowling", "Harry Potter and the Chamber of Secrets", 85141);
INSERT INTO books (author, title, words)
    VALUES ("J.K. Rowling", "Harry Potter and the Prisoner of Azkaban", 107253);
INSERT INTO books (author, title, words)
    VALUES ("J.K. Rowling", "Harry Potter and the Goblet of Fire", 190637);
INSERT INTO books (author, title, words)
    VALUES ("J.K. Rowling", "Harry Potter and the Order of the Phoenix", 257045);
INSERT INTO books (author, title, words)
    VALUES ("J.K. Rowling", "Harry Potter and the Half-Blood Prince", 168923);
INSERT INTO books (author, title, words)
    VALUES ("J.K. Rowling", "Harry Potter and the Deathly Hallows", 197651);

INSERT INTO books (author, title, words)
    VALUES ("Stephenie Meyer", "Twilight", 118501);
INSERT INTO books (author, title, words)
    VALUES ("Stephenie Meyer", "New Moon", 132807);
INSERT INTO books (author, title, words)
    VALUES ("Stephenie Meyer", "Eclipse", 147930);
INSERT INTO books (author, title, words)
    VALUES ("Stephenie Meyer", "Breaking Dawn", 192196);
    
INSERT INTO books (author, title, words)
    VALUES ("J.R.R. Tolkien", "The Hobbit", 95022);
INSERT INTO books (author, title, words)
    VALUES ("J.R.R. Tolkien", "Fellowship of the Ring", 177227);
INSERT INTO books (author, title, words)
    VALUES ("J.R.R. Tolkien", "Two Towers", 143436);
INSERT INTO books (author, title, words)
    VALUES ("J.R.R. Tolkien", "Return of the King", 134462);
    
SELECT author,
SUM(words) 
AS total_words
FROM books
GROUP BY author
HAVING total_words >= 1000000;

SELECT author, 
AVG(words) 
AS avg_words 
FROM books 
GROUP BY author 
HAVING avg_words >= 150000;

 
